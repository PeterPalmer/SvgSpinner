var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},Main;(function(n){var t=function(n){function t(t){n.call(this),this.document=t,this.mouseXQueue=[],this.mouseYQueue=[],this.selectedIcon=null}return __extends(t,n),t.prototype.RegisterEventHandlers=function(){for(var i=this.document.getElementsByTagName("svg"),t,n=0;n<i.length;n++)i[n].onclick=this.cb_onIconClicked;t=document.getElementById("canvas"),t.onmousemove=this.cb_onMouseMove,t.onmousedown=this.cb_onMouseDown,t.onmouseup=this.cb_onMouseUp},t.prototype.SetupCanvas=function(){var t=document.getElementById("canvas"),n;this.ctx=t.getContext("2d"),this.ctx.lineWidth=3,this.ctx.fillRect(0,0,Globals.width,Globals.height),this.ctx.translate(Globals.width/2,Globals.height/2),n="M27.812,16l-3.062-3.062V5.625h-2.625v4.688L16,4.188L4.188,16L7,15.933v11.942h17.875V16H27.812zM16,26.167h-5.833v-7H16V26.167zM21.667,23.167h-3.833v-4.042h3.833V23.167z",this.spinnerModel=new Shapes.SpinnerModel(n),this.spinnerModel.CenterAndScale(),this.intervalId=setInterval(this.cb_tick,Globals.frame_time)},t.prototype.cb_tick=function(){this.ctx.clearRect(Globals.width/-2,Globals.height/-2,Globals.width,Globals.height),this.spinnerModel.Draw(this.ctx)},t.prototype.cb_onIconClicked=function(n){var t,i,r;for(this.selectedIcon&&(this.selectedIcon.className.baseVal=""),this.spinnerModel.Clear(),this.selectedIcon=n.currentTarget,this.selectedIcon.className.baseVal+=" selected",t=this.selectedIcon.firstElementChild;t;)i=t.attributes.fill.value,r=t.attributes.stroke.value,this.spinnerModel.LoadSvgPath(t.attributes.d.value,i,r),t=t.nextElementSibling;this.spinnerModel.CenterAndScale()},t.prototype.cb_onMouseMove=function(n){var t=n.layerX-this.ctx.canvas.offsetLeft-Globals.width/2,i=n.layerY-this.ctx.canvas.offsetTop-Globals.height/2;this.mouseXQueue.length!=0&&Math.abs(this.mouseXQueue[this.mouseXQueue.length-1]-t)<6&&Math.abs(this.mouseYQueue[this.mouseYQueue.length-1]-i)<6||(this.mouseXQueue.push(t),this.mouseYQueue.push(i),Globals.yawSpeed=.0003*(this.mouseXQueue[this.mouseXQueue.length-1]-this.mouseXQueue[0]),Globals.pitchSpeed=.0003*(this.mouseYQueue[0]-this.mouseYQueue[this.mouseYQueue.length-1]),Globals.yawSpeed>.08&&(Globals.yawSpeed=.08),Globals.yawSpeed<-.08&&(Globals.yawSpeed=-.08),Globals.pitchSpeed>.08&&(Globals.pitchSpeed=.08),Globals.pitchSpeed<-.08&&(Globals.pitchSpeed=-.08),this.mouseXQueue.length>8&&(this.mouseXQueue.shift(),this.mouseYQueue.shift()))},t.prototype.cb_onMouseDown=function(){clearInterval(this.intervalId)},t.prototype.cb_onMouseUp=function(){this.intervalId=setInterval(this.cb_tick,Globals.frame_time)},t}(n.HasCallbacks);n.SvgSpinner=t})(Main||(Main={})),window.onload=function(){var n=new Main.SvgSpinner(document);n.RegisterEventHandlers(),n.SetupCanvas()}